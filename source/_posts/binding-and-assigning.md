title: 绑定和赋值(binding & assigning)
date: 2015-08-30 21:33:15
tags: rust
---

Rust 是一种静态强类型语言，很多刚从 C 系语言(C/C++/Java/)转过来的人，
对于下面的写法感到很不解

```rust
let a = "Hello";
let a = 5i32;
```

强类型怎么可以让 `a` 一会儿是 `&str` 一会是 `i32` 呢，这不跟动态类型语
言一样了吗。之所以会有这样的疑惑是因为把 `let` 理解成普通的赋值
(assigning)了，然而实际上 `let` 语句是绑定(binding)。


什么是 binding 呢，它与赋值又有什么区别呢？想知道比较确切的定义，可以
看[维基百科](https://en.wikipedia.org/wiki/Name_binding)定义。


这里我给一个比较通俗的解释：医院里一波刚出生的小孩，还没有起名字，为了
区别它们我们需要给它们起个名字，这就称为绑定。因为孩子是属于不同父母的，
所以可能多家父母都给孩子起了相同的名字，这叫重新绑定(rebinding)，但是
相同场景下，同名的孩子会有冲突，但机器选择用栈处理这种冲突，照顾后出生
的小孩，名字就先归后出生的小孩，等小小孩走了，名字再归大小孩。而重新赋
值是怎么回事呢？小小孩生病变成病小孩或长大变成大小孩，跟原来的小小孩不
太一样了，但仍然是那个小孩，在一个严格的社会(强类型系统)中不会从小男孩
变成小女孩。


对应到计算机上，小孩就是内存，内存与名字关联称为绑定，名字可以随意起，
但是在强类型系统中同一块内存却是不允许写不同类型的东西的。相同作用域中，
同名绑定按栈来管理，后绑定的会暂时 shadow 之前的绑定。


Rust 中的变量默认是不可变的，要可变的变量，需要额外加上 `mut` 修饰，而
绑定则可以随意，但为了程序的可读性，一般也不会随意绑定不同的值到同一个
名字上。


所以不要再把 rebinding 当成 assigning 了，其实 C 系语言也是区分这两个
概念的，维基百科上也给了一个 Java 的例子

```java
LinkedList<String> list;
list = new LinkedList<String>();
list.add("foo");
list = null;
```

第2行 list 先绑定到一个链表对象，然后对其赋值，最后又将其绑定到 null


另外提一下 Rust 的 let 是模式匹配，可以玩出很多花样来，比通常的 var,
val, mut 这些方式引入变量的方式强大太多了，感兴趣的可以参考我在知乎上
的[回答](http://www.zhihu.com/question/31135994)
